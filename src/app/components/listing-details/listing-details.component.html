<div id="create-btn-wrapper">
  <app-button
    text="Create a Listing"
    routerLink="/listing-creation"
    id="create-btn"
  />
</div>

<div *ngIf="listing" class="listing-details">
  <div class="button-container" *ngIf="listing.user.id === userId">
    <app-button
      (click)="toggleEditMode()"
      [text]="editMode ? 'Cancel Edit' : 'Edit'"
    />
    <app-button
      (click)="deleteListing(listing.id)"
      text="Delete"
      [isRed]="true"
    />
  </div>
  <div *ngIf="!editMode">
    <h2>{{ listing.title }}</h2>

    <p><strong>Description:</strong> {{ listing.description }}</p>
    <p><strong>Property Address:</strong> {{ listing.propertyAddress }}</p>
    <p><strong>Price (night):</strong> {{ listing.price }} â‚¬</p>
    <p><strong>Amenities:</strong></p>
    <ul>
      <li *ngFor="let amenity of listing.amenities">
        {{ amenity | amenities }}
      </li>
    </ul>
    <p>
      <strong>Posted by: </strong> {{ listing.user.firstName }}
      {{ listing.user.lastName }}
    </p>
    <div class="image-slider">
      <div
        class="slider-container"
        *ngIf="listing.images && listing.images.length"
      >
        <button class="prev-btn" (click)="prevImage()">&#10094;</button>
        <div class="slider" [style.transform]="getSliderTransform()">
          <img
            *ngFor="let image of listing.images"
            [src]="'data:' + image.type + ';base64,' + image.data"
            alt="Listing Image"
          />
        </div>
        <button class="next-btn" (click)="nextImage()">&#10095;</button>
      </div>
    </div>
  </div>
  <div *ngIf="editMode">
    <div>
      <label for="title">Title:</label>
      <input
        type="text"
        id="title"
        [(ngModel)]="listing.title"
        name="title"
        required
      />
    </div>
    <div>
      <label for="description">Description:</label>
      <input
        type="text"
        id="description"
        [(ngModel)]="listing.description"
        name="description"
        required
      />
    </div>
    <div>
      <label for="propertyAddress">Property Address:</label>
      <input
        type="text"
        id="propertyAddress"
        [(ngModel)]="listing.propertyAddress"
        name="propertyAddress"
        required
      />
    </div>
    <div>
      <label for="price">Price:</label>
      <input
        type="number"
        id="price"
        [(ngModel)]="listing.price"
        name="price"
        required
      />
    </div>
    <div>
      <label for="images">Images:</label>
      <input
        type="file"
        (change)="onFileChange($event)"
        multiple
        accept="image/*"
      />
      <p *ngIf="uploadedFiles.length">Uploaded Images:</p>
      <div *ngFor="let file of uploadedFiles">{{ file.name }}</div>
    </div>
    <div>
      <label for="amenities">Amenities:</label>
      <div *ngFor="let amenity of amenities">
        <input
          type="checkbox"
          [value]="amenity"
          (change)="toggleAmenity(amenity)"
          [checked]="listing.amenities.includes(amenity)"
        />
        {{ amenity }}
      </div>
    </div>
    <button (click)="saveChanges()">Save</button>
  </div>
</div>
